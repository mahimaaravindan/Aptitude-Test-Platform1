<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
    <style>
        .question {
            display: none;
        }
        .navigation-buttons {
            display: flex;
            justify-content: flex-end;
            gap: 10px;
            margin-top: 10px;
        }
        .navigation-buttons button {
            background-color: green;
            color: white;
            border: none;
            padding: 10px 20px;
            cursor: pointer;
        }
        .submit-button {
            display: block;
            background-color: black;
            color: white;
            border: none;
            padding: 15px 30px;
            margin: 30px auto 0;
            cursor: pointer;
        }
    </style>
    <script>
        let currentQuestion = 0;

        // Function to start the timer
        function startTimer(duration, display) {
            let timer = duration, minutes, seconds;
            let interval = setInterval(function () {
                minutes = parseInt(timer / 60, 10);
                seconds = parseInt(timer % 60, 10);

                minutes = minutes < 10 ? "0" + minutes : minutes;
                seconds = seconds < 10 ? "0" + seconds : seconds;

                display.textContent = minutes + ":" + seconds;

                if (--timer < 0) {
                    clearInterval(interval);
                    document.getElementById('testForm').submit(); // Automatically submit the form
                }
            }, 1000);
        }

        window.onload = function () {
            let fifteenMinutes = 60 * 5,
                display = document.querySelector('#time');
            startTimer(fifteenMinutes, display);
            showQuestion(currentQuestion);
        };

        function showQuestion(index) {
            let questions = document.querySelectorAll('.question');
            questions.forEach((question, i) => {
                question.style.display = (i === index) ? 'block' : 'none';
            });
        }

        function nextQuestion() {
            let questions = document.querySelectorAll('.question');
            if (currentQuestion < questions.length - 1) {
                currentQuestion++;
                showQuestion(currentQuestion);
            }
        }

        function prevQuestion() {
            if (currentQuestion > 0) {
                currentQuestion--;
                showQuestion(currentQuestion);
            }
        }
    </script>
</head>
<body>
    <header>
        <div class="container">
            <h1>Aptitude Test</h1>
            <div id="time" style="font-size: 20px; color: red;">15:00</div> <!-- Timer Display -->
        </div>
    </header>

    <main>
        <div class="container">
            <form id="testForm" action="{{ url_for('submit_test') }}" method="post">
                {% for question in questions %}
                <div class="question">
                    <p>{{ loop.index }}. {{ question['question'] }}</p>
                    <label><input type="radio" name="q{{ question['id'] }}" value="1"> {{ question['option1'] }}</label><br>
                    <label><input type="radio" name="q{{ question['id'] }}" value="2"> {{ question['option2'] }}</label><br>
                    <label><input type="radio" name="q{{ question['id'] }}" value="3"> {{ question['option3'] }}</label><br>
                    <label><input type="radio" name="q{{ question['id'] }}" value="4"> {{ question['option4'] }}</label>
                    <div class="navigation-buttons">
                        <button type="button" onclick="prevQuestion()">Back</button>
                        <button type="button" onclick="nextQuestion()">Next</button>
                    </div>
                </div>
                {% endfor %}
                <button type="submit" class="submit-button">Submit Test</button>
            </form>
        </div>
    </main>
</body>
</html>
